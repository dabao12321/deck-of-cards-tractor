var Deck=(()=>{function l(n){return document.createElement(n)}var r,i=[];function b(n,t){var n=Date.now()+n,e={start:n,end:n+t},o=(i.push(e),r||(r=!0,requestAnimationFrame(u)),{start:function(n){return e.startcb=n,o},progress:function(n){return e.progresscb=n,o},end:function(n){return e.endcb=n,o}});return o}function u(){var n=Date.now();if(i.length){for(var t,e,o=0;o<i.length;o++)n<(e=i[o]).start||(e.started||(e.started=!0,e.startcb&&e.startcb()),t=(n-e.start)/(e.end-e.start),e.progresscb&&e.progresscb(t<1?t:1),e.end<n&&(e.endcb&&e.endcb(),i.splice(o--,1)));requestAnimationFrame(u)}else r=!1}window.requestAnimationFrame||(window.requestAnimationFrame=function(n){setTimeout(n,0)});var a,g={linear:function(n){return n},quadIn:function(n){return n*n},quadOut:function(n){return n*(2-n)},quadInOut:function(n){return n<.5?2*n*n:(4-2*n)*n-1},cubicIn:function(n){return n*n*n},cubicOut:function(n){return--n*n*n+1},cubicInOut:function(n){return n<.5?4*n*n*n:(n-1)*(2*n-2)*(2*n-2)+1},quartIn:function(n){return n*n*n*n},quartOut:function(n){return 1- --n*n*n*n},quartInOut:function(n){return n<.5?8*n*n*n*n:1-8*--n*n*n*n},quintIn:function(n){return n*n*n*n*n},quintOut:function(n){return 1+--n*n*n*n*n},quintInOut:function(n){return n<.5?16*n*n*n*n*n:1+16*--n*n*n*n*n}};function c(){return window.getComputedStyle(document.body).getPropertyValue("font-size").slice(0,-2)}var d,n={deck:function(n){n.bysuit=n.queued(function(t){var e=n.cards;a=c(),e.forEach(function(n){n.bysuit(function(n){n===e.length-1&&t()})})})},card:function(e){var o=e.rank,r=e.suit;e.bysuit=function(n){var t=e.i;e.animateTo({delay:10*t,duration:400,x:-Math.round(8*(6.75-o)*a/16),y:-Math.round(92*(1.5-r)*a/16),rot:0,onComplete:function(){n(t)}})}}},t={deck:function(n){n.fan=n.queued(function(e){var o=n.cards,r=o.length;d=c(),o.forEach(function(n,t){n.fan(t,r,function(n){n===o.length-1&&e()})})})},card:function(i){var u=i.$el;i.fan=function(n,t,e){var o=n/4,r=10*n,t=n/(t-1)*260-130;i.animateTo({delay:r,duration:300,x:-o,y:-o,rot:0}),i.animateTo({delay:300+r,duration:300,x:55*Math.cos(s(t-90))*d/16,y:55*Math.sin(s(t-90))*d/16,rot:t,onStart:function(){u.style.zIndex=n},onComplete:function(){e(n)}})}}};function s(n){return n*Math.PI/180}var f,p=document.createElement("p").style,y={};function m(n){if(void 0!==y[n])return y[n];if(void 0!==p[n])return y[n]=n;for(var t,e=n[0].toUpperCase()+n.slice(1),o=["webkit","moz","Moz","ms","o"],r=0,i=o.length;r<i;r++)if(void 0!==p[t=o[r]+e])return y[n]=t}function k(n,t,e){var o,r;return e=e||0,(f=void 0===f?!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(o=m("transform"),r=document.createElement("p"),document.body.appendChild(r),r.style[o]="translate3d(1px,1px,1px)",f=null!=(f=r.style[o])&&f.length&&"none"!==f,document.body.removeChild(r),f):f)?"translate3d("+n+", "+t+", "+e+")":"translate("+n+", "+t+")"}var h,v,e={deck:function(n){n.intro=n.queued(function(e){var o=n.cards;o.forEach(function(t,n){t.setSide("front"),t.intro(n,function(n){b(250,0).start(function(){t.setSide("back")}),n===o.length-1&&e()})})})},card:function(r){var i=m("transform"),u=r.$el;r.intro=function(n,t){var e=500+10*n,o=n/4;u.style[i]=k(-o+"px","-250px"),u.style.opacity=0,r.x=-o,r.y=-250-o,r.rot=0,r.animateTo({delay:e,duration:1e3,x:-o,y:-o,onStart:function(){u.style.zIndex=n},onProgress:function(n){u.style.opacity=n},onComplete:function(){u.style.opacity="",t&&t(n)}})}}},o={deck:function(t){t.poker=t.queued(function(e){var n=t.cards,o=n.length;h=c(),n.slice(-5).reverse().forEach(function(t,n){t.poker(n,o,function(n){t.setSide("front"),4===n&&e()})})})},card:function(o){var r=o.$el;o.poker=function(n,t,e){o.animateTo({delay:250*n,duration:250,x:Math.round(70*(n-2.05)*h/16),y:Math.round(-110*h/16),rot:0,onStart:function(){r.style.zIndex=t-1+n},onComplete:function(){e(n)}})}}},x={deck:function(n){n.shuffle=n.queued(function(e){var o=n.cards;v=c(),(n=>{for(var t,e,o=n.length-1;o;o--)t=Math.floor(Math.random()*(o+1)),e=n[o],n[o]=n[t],n[t]=e})(o),o.forEach(function(n,t){n.pos=t,n.shuffle(function(n){n===o.length-1&&e()})})})},card:function(i){var u=i.$el;i.shuffle=function(n){var t,e=i.pos,o=e/4,r=2*e;i.animateTo({delay:r,duration:200,x:(t=40*Math.random()+20,(Math.round(Math.random())?-1:1)*t*v/16),y:-o,rot:0}),i.animateTo({delay:200+r,duration:200,x:-o,y:-o,rot:0,onStart:function(){u.style.zIndex=e},onComplete:function(){n(e)}})}}},w={deck:function(n){n.sort=n.queued(function(e,o){var r=n.cards;r.sort(function(n,t){return o?n.i-t.i:t.i-n.i}),r.forEach(function(n,t){n.sort(t,r.length,function(n){n===r.length-1&&e()},o)})})},card:function(u){var a=u.$el;u.sort=function(n,t,e,o){var r=n/4,i=10*n;u.animateTo({delay:i,duration:400,x:-r,y:-150,rot:0,onComplete:function(){a.style.zIndex=n}}),u.animateTo({delay:500+i,duration:400,x:-r,y:-r,rot:0,onComplete:function(){e(n)}})}}},q={deck:function(t){t.flip=t.queued(function(n,e){var o=t.cards.filter(function(n){return"front"===n.side}).length/t.cards.length;t.cards.forEach(function(n,t){n.setSide(e||(.5<o?"back":"front"))}),n()})}};function C(n){var o={};return(n=n||{}).on=function(n,t,e){o[n]||(o[n]=[]),o[n].push({cb:t,ctx:e})},n.one=function(n,t,e){o[n]||(o[n]=[]),o[n].push({cb:t,ctx:e,once:!0})},n.off=function(n,t){n?o[n]=t?o[n].filter(function(n){return n.cb!==t}):[]:o={}},n.trigger=function(n){var t=this,e=Array.prototype.slice(arguments,1);(o[n]||[]).filter(function(n){return n.cb.apply(t,e),!n.once})},n}function S(n){var r=Array.prototype,e=[];function i(n){n&&(e.push(n),1===e.length)&&!function t(){e[0](function(n){if(n)throw n;(e=e.slice(1)).length&&t()})}()}n.queue=i,n.queued=function(o){return function(){var t=this,e=arguments;i(function(n){o.apply(t,r.concat.apply(n,e))})}}}var I=52;function M(n){var t,e,h=m("transform"),o=n%13+1,r=n/13|0,i=(52-n)/4,v=l("div"),u=l("div"),a=l("div"),c=!1,d=!1,x={i:n,rank:o,suit:r,pos:n,$el:v,mount:function(n){n.appendChild(v),x.$root=n},unmount:function(){x.$root&&x.$root.removeChild(v),x.$root=null},setSide:function(n){"front"===n?("back"===x.side&&v.removeChild(a),x.side="front",v.appendChild(u),x.setRankSuit(x.rank,x.suit)):("front"===x.side&&v.removeChild(u),x.side="back",v.appendChild(a),v.setAttribute("class","card"))}},s=O.modules;for(t in u.classList.add("face"),a.classList.add("back"),v.style[h]=k(-i+"px",-i+"px"),x.x=-i,x.y=-i,x.z=i,x.rot=0,x.setSide("back"),E(v,"mousedown",f),E(v,"touchstart",f),s)(e=s[t]).card&&e.card(x);return x.animateTo=function(n){var e,o,r,i,u,a,t=n.delay,c=n.x,d=void 0===c?x.x:c,c=n.y,s=void 0===c?x.y:c,c=n.rot,f=void 0===c?x.rot:c,l=n.ease,p=n.onStart,y=n.onProgress,m=n.onComplete;b(t,n.duration).start(function(){e=x.x||0,o=x.y||0,r=x.rot||0,p&&p()}).progress(function(n){var t=g[l||"cubicInOut"](n);i=d-e,u=s-o,a=f-r,y&&y(n,t),x.x=e+i*t,x.y=o+u*t,x.rot=r+a*t,v.style[h]=k(x.x+"px",x.y+"px")+(a?"rotate("+x.rot+"deg)":"")}).end(function(){m&&m()})},x.setRankSuit=function(n,t){t=0===(t=t)?"spades":1===t?"hearts":2===t?"clubs":3===t?"diamonds":"joker";v.setAttribute("class","card "+t+" rank"+n)},x.setRankSuit(o,r),x.enableDragging=function(){c||(c=!0,v.style.cursor="move")},x.enableFlipping=function(){d=d||!0},x.disableFlipping=function(){d=d&&!1},x.disableDragging=function(){c&&(c=!1,v.style.cursor="")},x;function f(n){var t={},e={},o=Date.now();function r(n){c&&("mousemove"===n.type?(e.x=n.clientX,e.y=n.clientY):(e.x=n.touches[0].clientX,e.y=n.touches[0].clientY),v.style[h]=k(Math.round(x.x+e.x-t.x)+"px",Math.round(x.y+e.y-t.y)+"px")+(x.rot?" rotate("+x.rot+"deg)":""))}function i(n){d&&Date.now()-o<200&&x.setSide("front"===x.side?"back":"front"),"mouseup"===n.type?(A(window,"mousemove",r),A(window,"mouseup",i)):(A(window,"touchmove",r),A(window,"touchend",i)),c&&(x.x=x.x+e.x-t.x,x.y=x.y+e.y-t.y)}n.preventDefault(),"mousedown"===n.type?(t.x=e.x=n.clientX,t.y=e.y=n.clientY,E(window,"mousemove",r),E(window,"mouseup",i)):(t.x=e.x=n.touches[0].clientX,t.y=e.y=n.touches[0].clientY,E(window,"touchmove",r),E(window,"touchend",i)),c&&(v.style[h]=k(x.x+"px",x.y+"px")+(x.rot?" rotate("+x.rot+"deg)":""),v.style.zIndex=I++)}}function E(n,t,e){n.addEventListener(t,e)}function A(n,t,e){n.removeEventListener(t,e)}function O(n){var t,e,o,r,i=new Array(n?54:52),u=l("div"),a=C({mount:function(n){(t=n).appendChild(u)},unmount:function(){t.removeChild(u)},cards:i,$el:u}),c=O.modules;for(e in S(a),c)(o=c[e]).deck&&o.deck(a);u.classList.add("deck");for(var d=i.length;d;d--)(r=i[d-1]=M(d-1)).setSide("back"),r.mount(u);return a}return O.animationFrames=b,O.ease=g,O.modules={bysuit:n,fan:t,intro:e,poker:o,shuffle:x,sort:w,flip:q},O.Card=M,O.prefix=m,O.translate=k,O})();